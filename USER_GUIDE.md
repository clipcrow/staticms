# Staticms ユーザーガイド

Staticms は、GitHub
リポジトリをデータベースとして利用する、開発者に優しいヘッドレス CMS です。
専門的な知識がなくても、直感的な UI で Markdown
記事の執筆や画像の管理が行えます。

## 目次

1. [ログインと開始](#1-ログインと開始)
2. [コンテンツのブラウジング](#2-コンテンツのブラウジング)
3. [記事の編集と管理](#3-記事の編集と管理)
   - [エディタ画面の構成](#エディタ画面の構成)
   - [画像のアップロードと挿入](#画像のアップロードと挿入)
   - [ドラフト（自動保存）機能](#ドラフト自動保存機能)
4. [保存と公開 (Pull Request)](#4-保存と公開-pull-request)
5. [設定と管理](#5-設定と管理)
   - [ブランチ管理](#ブランチ管理)
   - [コンテンツ設定の編集](#コンテンツ設定の編集)

---

## 1. ログインと開始

Staticms のトップページにアクセスすると、GitHub
認証画面へリダイレクトされます（初回のみ）。
「Authorize」ボタンを押して、Staticms
があなたのリポジトリにアクセスすることを許可してください。

ログインに成功すると、**リポジトリ一覧画面** が表示されます。
カード形式で表示されたリポジトリの中から、編集したい対象をクリックしてください。

> **Connect Repository**:
> まだ接続していないリポジトリがある場合は、右上の「Connect
> Repository」ボタンから GitHub App
> の設定画面へ移動し、アクセス権を追加してください。

## 2. コンテンツのブラウジング

リポジトリを選択すると、管理されているコンテンツタイプ（Collection /
Singleton）の一覧がカード形式で表示されます。 （例: Blog Posts, Pages など）

- **設定 (Settings)**:
  各カード内の歯車アイコンから、そのコンテンツの設定画面へ移動できます。
- **新規追加**: まだコンテンツ設定がない場合は、「Add New
  Content」ボタンから新しいコンテンツ定義を作成できます。

編集したいコンテンツ（Collection）をクリックすると、**記事一覧画面**へ移動します。
ここでも記事はカード形式で表示されます。

- **記事の作成**:
  上部の入力フォームに記事名（スラッグ）を入力し、「Create」ボタンを押すことで新規記事を作成・編集開始できます。
- **検索**: 検索ボックスを使って記事をフィルタリングできます。

## 3. 記事の編集と管理

### エディタ画面の構成

エディタ画面は以下のエリアで構成されています。

1. **ヘッダー**: パンくずリスト、ステータス表示、「Save」ボタンがあります。
2. **メタデータ設定 (Sidebar/Main)**:
   タイトル、日付、タグなどの記事情報を入力するフォームです。
3. **本文エディタ**: Markdown 形式で本文を執筆するエリアです。
   - **Markdown Editor**: プレビューを見ながら執筆できます。
   - **YAML Editor**: データのみを扱う場合はYAML形式で編集します。

### 画像のアップロードと挿入

記事内に画像を挿入するには、以下の簡単な操作で可能です。

1. **ドラッグ＆ドロップ**:
   画像ファイルをエディタのテキストエリアに直接ドロップします。
2. **自動リンク挿入**: ドロップすると、即座に Markdown 形式の画像リンク
   `![filename.png](filename.png)` が挿入されます。
3. **サイドバー管理**:
   サイドバーの「Images」パネルで、アップロードされた画像（Pending）や、記事と同じフォルダにある画像（Nearby）を確認・挿入できます。

### ドラフト（自動保存）機能

執筆中の内容は、**ブラウザ内に自動的に保存（ドラフト）**されます。
サーバーへの保存（コミット）を行うまでは、内容はローカルにのみ存在します。

- **安心の執筆**:
  誤ってブラウザを閉じても、次回アクセス時に続きから執筆できます。
- **リセット**:
  サーバー上の最新の状態に戻したい場合は、メニューからドラフトを破棄できます。

## 4. 保存と公開 (Pull Request)

書き終わったら、ヘッダー右上の **「Save」** ボタンを押してください。

1. **Pull Request (PR) の作成**:
   - あなたの変更内容は、新しい「Pull Request」として GitHub に送信されます。
   - まだ本番サイトには反映されず、レビュー待ちの状態になります。
2. **ロック機能**:
   - PR が作成されると、その記事は「**Locked (PR Open)**」状態になり、PR
     がマージまたはクローズされるまで再編集できなくなります。
   - これにより、チーム開発時の編集競合を防ぎます。
3. **公開**:
   - GitHub 上で PR をマージすると、本番サイトに変更が反映され、Staticms
     上のロックも解除されます。

## 5. 設定と管理

### ブランチ管理

リポジトリ内で編集対象とするブランチを切り替えることができます。

- リポジトリ一覧の各カードにある「Branch」アイコン、またはリポジトリトップのメニューからアクセスできます。
- **Target Branch**:
  編集内容をコミットするブランチを指定します。存在しない場合は自動作成されます。
- **Unmerged Commits**:
  ターゲットブランチにあってデフォルトブランチにないコミットが表示されます。ここから本番反映用の
  Pull Request を作成することも可能です。

### コンテンツ設定の編集

新しい種類のコンテンツ（例:
"News"）を増やしたい場合や、既存の設定（フォルダーパスやフィールド定義）を変更したい場合は、設定画面を使用します。

- **Content Name**: UI 上での表示名。
- **Type**: 複数記事を管理する `Collection` か、単一ファイルを管理する
  `Singleton` かを選択。
- **Binding**:
  コンテンツを単一ファイルとして保存するか、フォルダとして保存するかを選択。
- **Fields**: タイトルや日付など、Frontmatter で管理するフィールドを定義します。
